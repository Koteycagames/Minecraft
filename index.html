<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Minecraft JS: Menu</title>
    <style>
        body { 
            margin: 0; 
            font-family: 'Courier New', monospace; 
            background: url('./textures/dirt.png'); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            color: white; 
            overflow: hidden; /* Чтобы не было полос прокрутки */
        }
        /* Затемнение фона */
        body::before { 
            content: ""; position: absolute; top:0; left:0; width:100%; height:100%; 
            background: rgba(0,0,0,0.6); z-index: -1; 
        }

        h1 { 
            font-size: 60px; /* Чуть меньше, чтобы не занимало пол-экрана */
            text-shadow: 4px 4px #000; 
            margin-bottom: 20px; 
            font-weight: bold;
            color: #ddd;
        }

        /* КНОПКИ (Аккуратные) */
        .mc-btn { 
            width: 300px; /* Оптимальная ширина */
            padding: 10px; /* Меньше высота */
            margin: 5px 0; /* Меньше отступы */
            font-size: 16px; 
            color: #ddd; 
            background: #777; 
            border: 2px solid; /* Тонкая рамка у кнопок */
            border-color: #aaa #555 #555 #aaa; 
            cursor: pointer; 
            text-shadow: 1px 1px #000;
            display: block;
            text-align: center;
        }
        .mc-btn:hover { background: #888; color: #fff; border-color: #bbb #666 #666 #bbb; }
        .mc-btn:active { border-color: #555 #aaa #aaa #555; }

        .mc-input { 
            padding: 8px; width: 280px; margin: 5px 0; 
            background: #000; border: 2px solid #aaa; 
            color: white; font-size: 16px; 
        }

        /* ПАНЕЛИ (Без рамок, просто контейнеры) */
        #auth-panel, #user-panel {
            /* Убрал border и background */
            display: none; 
            flex-direction: column; 
            align-items: center; 
            gap: 5px; /* Аккуратный зазор */
        }

        .link { color: #aaa; text-decoration: underline; cursor: pointer; margin-top: 10px; font-size: 14px; }
        .link:hover { color: #fff; }
        
        .welcome-text { font-size: 18px; margin-bottom: 15px; text-shadow: 1px 1px 0 #000; color: #aaa; }
    </style>
</head>
<body>
    <h1>MINECRAFT JS</h1>

    <div id="auth-panel" style="display: flex;"> 
        <input type="email" id="email" class="mc-input" placeholder="Email">
        <input type="password" id="pass" class="mc-input" placeholder="Пароль">
        <input type="text" id="nick" class="mc-input" placeholder="Никнейм" style="display:none;">
        
        <div style="height: 5px;"></div>
        
        <button class="mc-btn" onclick="handleAuth()" id="auth-btn">ВОЙТИ</button>
        <div class="link" onclick="toggleAuth()">Нет аккаунта? Регистрация</div>
    </div>

    <div id="user-panel">
        <div class="welcome-text">Привет, <span id="username" style="color:#ffff55; font-weight:bold;">Стив</span>!</div>
        
        <button class="mc-btn" onclick="window.location.href='worldselect.html'">Одиночная игра</button>
        <button class="mc-btn" onclick="window.location.href='multiplayer.html'">Сетевая игра</button>
        <button class="mc-btn" onclick="window.location.href='settings.html'">Настройки</button>
        
        <div style="height: 15px;"></div> <button class="mc-btn" onclick="logout()" style="width: 150px; background:#533; border-color:#855 #322 #322 #855;">Выйти</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const app = initializeApp({ 
            apiKey: "AIzaSyA-ZeBBpiBMwqGVfGL9bSunUu_d2dXVgcI", 
            authDomain: "minecraft-2ec53.firebaseapp.com" 
        });
        const auth = getAuth(app);

        let isReg = false;
        window.toggleAuth = () => {
            isReg = !isReg;
            document.getElementById('auth-btn').innerText = isReg ? "СОЗДАТЬ АККАУНТ" : "ВОЙТИ";
            document.getElementById('nick').style.display = isReg ? "block" : "none";
        };

        window.handleAuth = () => {
            const e = document.getElementById('email').value;
            const p = document.getElementById('pass').value;
            const n = document.getElementById('nick').value;
            
            if(isReg) {
                if(!n) return alert("Введи ник");
                createUserWithEmailAndPassword(auth, e, p).then(c => updateProfile(c.user, {displayName: n})).catch(e => alert(e.message));
            } else {
                signInWithEmailAndPassword(auth, e, p).catch(e => alert("Ошибка входа"));
            }
        };

        window.logout = () => signOut(auth);

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-panel').style.display = 'none';
                document.getElementById('user-panel').style.display = 'flex'; // Вертикально
                document.getElementById('username').innerText = user.displayName || "Игрок";
            } else {
                document.getElementById('auth-panel').style.display = 'flex';
                document.getElementById('user-panel').style.display = 'none';
            }
        });
    </script>
</body>
</html>
