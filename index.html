<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Minecraft JS: Menu</title>
    <style>
        body { 
            margin: 0; 
            font-family: 'Courier New', monospace; 
            /* ЖЕСТКИЙ ПУТЬ К НОВОЙ ПАПКЕ */
            background: url('./Textury/dirt.png'); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            color: white; 
            user-select: none; 
            overflow: hidden;
        }
        
        body::before { 
            content: ""; position: absolute; top:0; left:0; width:100%; height:100%; 
            background: rgba(0,0,0,0.75); z-index: -1; 
        }
        
        h1 { 
            font-size: 70px; 
            margin-bottom: 40px; 
            color: #fff;
            text-shadow: 4px 4px 0 #3f3f3f, 6px 6px 0 #000;
            font-weight: bold;
            letter-spacing: 2px;
        }
        
        .menu-box { 
            width: 400px; 
            display: flex; 
            flex-direction: column; 
            gap: 15px; 
        }
        
        .mc-btn { 
            padding: 15px; 
            font-size: 20px; 
            color: #ddd; 
            background: #777; 
            border: 4px solid; 
            border-color: #aaa #444 #444 #aaa; 
            cursor: pointer; 
            text-align: center; 
            font-family: inherit; 
            text-shadow: 2px 2px #222; 
            width: 100%; 
            box-sizing: border-box; 
            transition: 0.1s;
        }
        .mc-btn:active { 
            border-color: #444 #aaa #aaa #444; 
            background: #666;
        }
        .mc-btn:hover { 
            background: #888; 
            color: #fff; 
            text-shadow: 2px 2px #000;
        }
        
        .world-list { 
            display: none; 
            width: 600px; 
            height: 400px; 
            background: rgba(0,0,0,0.6); 
            border: 4px solid #555; 
            overflow-y: auto; 
            flex-direction: column; 
            margin-bottom: 20px; 
            padding: 10px;
            box-shadow: inset 0 0 20px #000;
        }
        
        .world-list::-webkit-scrollbar { width: 10px; background: #222; }
        .world-list::-webkit-scrollbar-thumb { background: #777; border: 2px solid #555; }

        .w-item { 
            padding: 15px; 
            margin-bottom: 10px;
            border: 2px solid #555; 
            background: rgba(0,0,0,0.4); 
            cursor: pointer; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            transition: 0.2s;
        }
        .w-item:hover { 
            background: rgba(255,255,255,0.1); 
            border-color: #aaa;
        }
        .w-info { display: flex; flex-direction: column; }
        .w-name { font-size: 20px; font-weight: bold; color: #fff; }
        .w-sub { font-size: 14px; color: #aaa; margin-top: 5px; }
        
        .modal { 
            display: none; 
            position: absolute; top:0; left:0; width:100%; height:100%; 
            background: rgba(0,0,0,0.85); 
            z-index: 100; 
            flex-direction: column; align-items: center; justify-content: center; 
            backdrop-filter: blur(5px);
        }
        .modal-box { 
            /* ФОН МОДАЛКИ ТОЖЕ ИЗ Textury */
            background: url('./Textury/stone.png'); 
            padding: 30px; 
            border: 4px solid #fff; 
            width: 450px; 
            display: flex; flex-direction: column; gap: 20px; 
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }
        .modal-title {
            margin: 0; text-align: center; font-size: 28px;
            text-shadow: 2px 2px #000;
        }
        .modal-label { font-size: 16px; color: #eee; margin-bottom: 5px; text-shadow: 1px 1px #000; }
        
        .mc-input, .mc-select { 
            width: 100%; padding: 12px; 
            background: #222; color: white; 
            border: 2px solid #555; 
            font-family: inherit; font-size: 18px; 
            box-sizing: border-box; 
        }
        
        .check-row { 
            display: flex; align-items: center; justify-content: space-between; 
            background: rgba(0,0,0,0.3); padding: 15px; border: 2px solid #555; 
        }
        .check-row input { transform: scale(2.0); cursor: pointer; }

        .btn-green { background: #484; border-color: #6a6 #262 #262 #6a6; }
        .btn-green:hover { background: #5a5; }
        
        .btn-red { background: #844; border-color: #a66 #622 #622 #a66; }
        .btn-red:hover { background: #a55; }

        #main-menu { display: flex; flex-direction: column; align-items: center; width: 100%; }
        #single-menu { display: none; flex-direction: column; align-items: center; width: 100%; }
    </style>
</head>
<body>

    <h1>MINECRAFT JS</h1>

    <div id="main-menu">
        <div class="menu-box">
            <button class="mc-btn" onclick="showSingle()">ОДИНОЧНАЯ ИГРА</button>
            <button class="mc-btn" onclick="window.location.href='multiplayer.html'">СЕТЕВАЯ ИГРА</button>
            <button class="mc-btn" onclick="openSettings()">НАСТРОЙКИ</button>
        </div>
    </div>

    <div id="single-menu">
        <h2 style="margin-top:0; font-size:30px; text-shadow:2px 2px #000;">ВЫБОР МИРА</h2>
        <div class="world-list" id="w-list"></div>
        <div class="menu-box" style="width: 600px; flex-direction: row;">
            <button class="mc-btn btn-green" onclick="openCreateModal()">СОЗДАТЬ НОВЫЙ МИР</button>
            <button class="mc-btn" onclick="showMain()">НАЗАД</button>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-box">
            <h2 class="modal-title">НАСТРОЙКИ</h2>
            <div>
                <div class="modal-label">Чувствительность мыши:</div>
                <input type="range" id="sens" min="0.1" max="2.0" step="0.1" style="width:100%">
            </div>
            <div>
                <div class="modal-label">Дальность прорисовки:</div>
                <input type="range" id="dist" min="20" max="100" step="10" style="width:100%">
            </div>
            <div class="check-row">
                <span style="font-size:18px; text-shadow:1px 1px #000;">PBR Текстуры (BETA)</span>
                <input type="checkbox" id="pbr_mode">
            </div>
            <button class="mc-btn" onclick="saveSettings()">ГОТОВО</button>
        </div>
    </div>

    <div id="create-world-modal" class="modal">
        <div class="modal-box">
            <h2 class="modal-title">СОЗДАНИЕ МИРА</h2>
            <div>
                <div class="modal-label">Название мира:</div>
                <input type="text" id="world-name" class="mc-input" placeholder="Новый мир">
            </div>
            <div>
                <div class="modal-label">Размер мира:</div>
                <select id="world-size" class="mc-select">
                    <option value="10">Маленький (10x10)</option>
                    <option value="30" selected>Обычный (30x30)</option>
                    <option value="50">Огромный (50x50)</option>
                </select>
            </div>
            <div>
                <div class="modal-label">Режим игры:</div>
                <select id="game-mode" class="mc-select">
                    <option value="survival">Выживание (Жизни, Голод)</option>
                    <option value="creative">Творческий (Полет, Бессмертие)</option>
                </select>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="mc-btn btn-green" onclick="createWorldFinal()">СОЗДАТЬ</button>
                <button class="mc-btn btn-red" onclick="closeCreateModal()">ОТМЕНА</button>
            </div>
        </div>
    </div>

    <script>
        function showSingle() { document.getElementById('main-menu').style.display = 'none'; document.getElementById('single-menu').style.display = 'flex'; loadWorlds(); }
        function showMain() { document.getElementById('single-menu').style.display = 'none'; document.getElementById('main-menu').style.display = 'flex'; }

        function loadWorlds() {
            const list = document.getElementById('w-list');
            list.innerHTML = '';
            const worlds = JSON.parse(localStorage.getItem('mc_worlds') || '{}');
            if(Object.keys(worlds).length === 0) list.innerHTML = '<div style="padding:20px; text-align:center; color:#aaa; font-size:20px;">Список миров пуст</div>';
            for(let name in worlds) {
                const w = worlds[name];
                const mode = w.mode ? (w.mode === 'creative' ? 'Творческий' : 'Выживание') : 'Выживание';
                const size = w.size ? `${w.size}x${w.size}` : '30x30';
                const date = new Date(w.created || Date.now()).toLocaleDateString();
                const div = document.createElement('div');
                div.className = 'w-item';
                div.innerHTML = `<div class="w-info"><span class="w-name">${name}</span><span class="w-sub">${mode} — ${size} — ${date}</span></div><button class="mc-btn btn-red" style="width:60px; padding:10px;" onclick="event.stopPropagation(); deleteWorld('${name}')">X</button>`;
                div.onclick = () => playWorld(name);
                list.appendChild(div);
            }
        }

        function openCreateModal() { document.getElementById('world-name').value = ''; document.getElementById('create-world-modal').style.display = 'flex'; document.getElementById('world-name').focus(); }
        function closeCreateModal() { document.getElementById('create-world-modal').style.display = 'none'; }

        function createWorldFinal() {
            const name = document.getElementById('world-name').value.trim() || "Новый мир";
            const size = parseInt(document.getElementById('world-size').value);
            const mode = document.getElementById('game-mode').value;
            const worlds = JSON.parse(localStorage.getItem('mc_worlds') || '{}');
            if(worlds[name]) return alert("Мир с таким именем уже существует!");
            worlds[name] = { blocks: {}, created: Date.now(), size: size, mode: mode };
            localStorage.setItem('mc_worlds', JSON.stringify(worlds));
            playWorld(name);
        }

        function playWorld(name) { localStorage.setItem('mc_mode', 'single'); localStorage.setItem('mc_current_world', name); window.location.href = 'game.html'; }
        function deleteWorld(name) { if(confirm('Удалить мир "' + name + '" навсегда?')) { const worlds = JSON.parse(localStorage.getItem('mc_worlds') || '{}'); delete worlds[name]; localStorage.setItem('mc_worlds', JSON.stringify(worlds)); loadWorlds(); } }

        function openSettings() {
            document.getElementById('settings-modal').style.display = 'flex';
            const s = JSON.parse(localStorage.getItem('mc_settings') || '{"sens":0.5, "dist":60, "pbr":false}');
            document.getElementById('sens').value = s.sens; document.getElementById('dist').value = s.dist; document.getElementById('pbr_mode').checked = s.pbr; 
        }

        function saveSettings() {
            const s = { sens: parseFloat(document.getElementById('sens').value), dist: parseInt(document.getElementById('dist').value), pbr: document.getElementById('pbr_mode').checked };
            localStorage.setItem('mc_settings', JSON.stringify(s));
            document.getElementById('settings-modal').style.display = 'none';
        }
    </script>
</body>
</html>
