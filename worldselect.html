<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Выбор мира</title>
    <style>
        body { margin: 0; font-family: 'Courier New', monospace; background: url('./textures/dirt.png'); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; color: white; }
        body::before { content: ""; position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); z-index: -1; }
        .list { width: 400px; height: 300px; background: rgba(0,0,0,0.5); border: 2px solid #555; overflow-y: auto; margin-bottom: 20px; }
        .item { padding: 10px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; cursor: pointer; }
        .item:hover { background: rgba(255,255,255,0.1); }
        .mc-btn { width: 400px; padding: 10px; margin: 5px; font-size: 18px; color: #ddd; background: #777; border: 4px solid #555; cursor: pointer; }
        .del { color: red; font-weight: bold; }
        .input-new { width: 380px; padding: 10px; margin-bottom: 10px; background: black; color: white; border: 2px solid #555; }
    </style>
</head>
<body>
    <h1>ВЫБОР МИРА</h1>
    <div class="list" id="world-list"></div>
    
    <input type="text" id="new-name" class="input-new" placeholder="Название нового мира">
    <button class="mc-btn" onclick="createWorld()">СОЗДАТЬ МИР</button>
    <button class="mc-btn" onclick="window.location.href='index.html'">НАЗАД</button> <script>
        function getWorlds() { return JSON.parse(localStorage.getItem('mc_worlds') || '{}'); }
        
        function render() {
            const list = document.getElementById('world-list');
            list.innerHTML = '';
            const worlds = getWorlds();
            for(let name in worlds) {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `<span onclick="load('${name}')">${name}</span> <span class="del" onclick="del('${name}')">X</span>`;
                list.appendChild(div);
            }
        }

        window.createWorld = () => {
            const name = document.getElementById('new-name').value.trim();
            if(!name) return;
            const w = getWorlds();
            if(w[name]) return alert("Имя занято");
            w[name] = { blocks: {} }; 
            localStorage.setItem('mc_worlds', JSON.stringify(w));
            load(name);
        };

        window.del = (name) => {
            if(!confirm('Удалить?')) return;
            const w = getWorlds();
            delete w[name];
            localStorage.setItem('mc_worlds', JSON.stringify(w));
            render();
        };

        window.load = (name) => {
            localStorage.setItem('mc_mode', 'single');
            localStorage.setItem('mc_current_world', name);
            window.location.href = 'game.html';
        };

        render();
    </script>
</body>
</html>
